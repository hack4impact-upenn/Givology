<!-- The mini-profiles on search pages -->

<div style="width: 100%;
            height:100px;
            padding: 1px 0 5px 0;
            overflow: hidden;
            font-size: 12px;">

	<div style="float: left;
	            width: 100px;
	            height: 100px;
	            margin-right:10px;
	            background: #fff url('{{obj.picurl}}')
	                        no-repeat scroll center;">
		<a href="{{obj.url}}"
		  style="display: block;
		         width: 100px;
		         height: 100px;"></a>
	</div>
	
	<a style="font-weight:bold;color:#417fc5;" href="/~{{ obj.uname }}/"> {{ obj.name }} </a>
	
	{% if obj.sudoable %}
	<div style="float: right;">
	<form name="sudoform{{obj.uname}}" method="POST" action="/login/">
		<input type="hidden" name="fauxuid" value="{{obj.uid}}" />
		<span class="show-with-script">
			<a href="javascript:document.sudoform{{obj.uname}}.submit();"> Act as this user </a>
		</span>
	</form>
	</div>
	{% endif %}
	<span style="color:#497912; font-weight:bold;">
	{% if obj.isrec %}
	<br />${{obj.grant_have}} of ${{obj.grant_want}} donated</span>
	{% endif %}
	
	<span style="color:#497912; font-weight:bold;">{% if obj.location %}<br /> {{obj.location}}{% endif %}</span>
	
	{% if obj.isorg %}
	<br />{% if obj.projects %}{{obj.projects}} project{% ifnotequal obj.projects 1 %}s{% endifnotequal %}{% endif %}{% if obj.projects and obj.students %}, {% endif %}{% if obj.students %}{{obj.students}} student{% ifnotequal obj.students 1 %}s{% endifnotequal %}{% endif%}
	{% endif %}
	
	{% if obj.isdonor %}
	<br />${{obj.pledged}} pledged to Givology so far
	{% endif %}
</span>	
	{% if obj.summary %}
	<br /><span id="truncateMe{{obj.uid}}" style="font-size: 12px;"> {{obj.summary}}</span>
	{% endif%}
	
</div>

<script type="text/javascript">

var len = 160;
var p = document.getElementById('truncateMe{{obj.uid}}');
if (p) {

  var trunc = p.innerHTML;
  if (trunc.length > len) {

    /* Truncate the content of the P, then go back to the end of the
       previous word to ensure that we don't truncate in the middle of
       a word */
    trunc = trunc.substring(0, len);
    trunc = trunc.replace(/\w+$/, '');

    /* Add an ellipses to the end and make it a link that expands
       the paragraph back to its original size */
    trunc += '<a href="{{obj.url}}">' +
      '...<\/a>';
    p.innerHTML = trunc;
  }
}

</script>
